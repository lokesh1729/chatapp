(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{103:function(e,t,a){},105:function(e,t,a){},106:function(e,t,a){},107:function(e,t,a){},113:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(20),s=a.n(r),c=a(5),l=a(6),i=a(8),u=a(7),m=a(9),p=a(31),h=a(54),d=a.n(h),g=a(15),f=a(32),b=a.n(f),E=function(e,t,a){return{type:e,payload:{msg:t,status:a}}},y=a(22),O=a(10),v=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).submitLogin=function(e){e.preventDefault(),a.props.login(a.state.username,a.state.password)},a.onChange=function(e){a.setState(Object(p.a)({},e.target.name,e.target.value))},a.state={username:"",password:""},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.state.isAuthenticated,t=d.a.parse(this.props.location.search).next;return o.a.createElement(n.Fragment,null,e?o.a.createElement(y.a,{to:t}):o.a.createElement(O.Section,{className:this.props.state.isLoading?"opacity-25":""},o.a.createElement(O.Container,null,o.a.createElement("form",{onSubmit:this.submitLogin},o.a.createElement(O.Field,null,o.a.createElement(O.Label,null,"Username"),o.a.createElement(O.Control,null,o.a.createElement(O.Input,{type:"text",onChange:this.onChange,name:"username",placeholder:"Enter username",required:!0}))),o.a.createElement(O.Field,null,o.a.createElement(O.Label,null,"Password"),o.a.createElement(O.Control,null,o.a.createElement(O.Input,{type:"password",onChange:this.onChange,name:"password",placeholder:"Enter password",required:!0}))),o.a.createElement(O.Field,null,o.a.createElement(O.Control,null,o.a.createElement(O.Button,{isColor:"primary",type:"submit"},"Submit")))))))}}]),t}(n.Component),j=Object(g.b)(function(e){return{state:e.login}},{login:function(e,t){return function(a){var n=JSON.stringify({username:e,password:t});a({type:"HTTP_CALL_INITIATED"}),b.a.post("/api/auth/login/",n,{headers:{"Content-Type":"application/json"}}).then(function(e){200===e.status?(a({type:"LOGIN",payload:e.data}),a({type:"MESSAGE",payload:{loginSuccess:"logged in successfully"}})):a(E("ERROR",e.statusText,e.status)),a({type:"HTTP_CALL_COMPLETED"})}).catch(function(e){a({type:"HTTP_CALL_COMPLETED"}),e.response&&a(E("ERROR",e.response.data,e.response.status)),console.log(e),a(E("ERROR",e.message,500))}).catch(function(e){return a(E("ERROR","Something went wrong!!!",e.response.status))})}}})(v),w=a(26),N=a(57),x=(a(103),function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e,t){var a=this.props,n=a.errors,o=a.alert,r=a.messages;n!==e.errors&&(n.msg.name&&o.error("Name: ".concat(n.msg.name.join())),n.msg.email&&o.error("".concat(n.status," : Email: ").concat(n.msg.email.join())),n.msg.non_field_errors&&o.error("".concat(n.status," : ").concat(n.msg.non_field_errors.join())),n.msg.username&&o.error(n.msg.username.join())),r!==e.messages&&r.loginSuccess&&o.success(r.loginSuccess)}},{key:"render",value:function(){return o.a.createElement(n.Fragment,null)}}]),t}(n.Component)),C=Object(g.b)(function(e){return{errors:e.errors,messages:e.messages}})(Object(w.d)()(x)),_=a(35),k=a(21),L=a(58),T=a(59),S=a(36),R=a(104),D={isAuthenticated:!!R.get("authToken"),isLoading:!1},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":var a=t.payload.token;return R.set("authToken",a,{path:"/",expires:new Date(t.payload.expiry)}),Object(S.a)({},e,{isAuthenticated:!0});case"HTTP_CALL_INITIATED":return Object(S.a)({},e,{isLoading:!0});case"HTTP_CALL_COMPLETED":return Object(S.a)({},e,{isLoading:!1});default:return e}},I={msg:{},status:""},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;return"ERROR"===t.type?{msg:t.payload.msg,status:t.payload.status}:e},M={msg:{}},F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MESSAGE":return t.payload;default:return e}},H=Object(k.combineReducers)({login:A,errors:P,messages:F}),B=[T.a],U=Object(k.createStore)(H,{},Object(L.composeWithDevTools)(k.applyMiddleware.apply(void 0,B))),J=function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement(n.Fragment,null,this.props.isLoading&&o.a.createElement("div",{className:"spinner"},o.a.createElement("img",{src:"assets/spinner.gif",alt:"loading"})))}}]),t}(n.Component),G=Object(g.b)(function(e){return{isLoading:e.login.isLoading}})(J),W=a(30),z=function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null,"Home Page")}}]),t}(n.Component),q=a(33),K=a(28),V=a(60),Y=a(61),$=(a(105),a(34)),Q=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).enterRoom=function(e){e.preventDefault(),a.props.history.push("/room/"+a.state.roomName)},a.roomNameChange=function(e){var t=e.target.value;a.setState(function(e){return{roomName:t}})},a.keyDownHandler=function(e){13===e.keyCode&&a.enterRoom(e)},a.state={roomName:""},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement(q.Section,{className:"room_enter__section"},o.a.createElement(K.Container,{className:"room__container"},o.a.createElement(Y.Label,{className:"room__label"},"Enter a room name:"),o.a.createElement(V.Input,{type:"text",className:"room__input",onChange:this.roomNameChange,onKeyDown:this.keyDownHandler}),o.a.createElement($.Button,{isColor:"primary",className:"large__btn",onClick:this.enterRoom},"Enter")))}}]),t}(n.Component),X=a(44),Z="/app";var ee=a(43),te=a(62),ae=(a(106),a(63)),ne=function(e){var t=function(t){function a(){return Object(c.a)(this,a),Object(i.a)(this,Object(u.a)(a).apply(this,arguments))}return Object(m.a)(a,t),Object(l.a)(a,[{key:"render",value:function(){var t,a=this.props.state.isAuthenticated;return o.a.createElement(n.Fragment,null,a?o.a.createElement(e,this.props):o.a.createElement(y.a,{to:"/login?next=".concat(encodeURIComponent((t=this.props.location.pathname+this.props.location.search,t.split(Z).join(""))))}))}}]),a}(o.a.Component);return Object(g.b)(function(e){return{state:e.login}},null)(Object(_.b)(t))}(function(e){function t(e){var a;Object(c.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).sendMessage=function(e){e.preventDefault(),a.state.socket.send(JSON.stringify({message:a.state.message,room_name:a.state.roomName})),a.setState(function(e){return{message:""}})},a.keyDownHandler=function(e){13===e.keyCode&&a.sendMessage(e)};var n=a.props.match.params.roomName;return a.state={socket:null,chatLog:[],message:"",roomName:n},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.cookies.get("authToken"),t="https:"===window.location.protocol?"wss:":"ws:",a=window.location.host,n=new WebSocket("".concat(t,"//").concat(a,"/ws/chat/").concat(this.state.roomName,"/")),o=this;n.onopen=function(e){console.log("opened connection...")},n.onmessage=function(e){var t=JSON.parse(e.data);o.setState(function(e){return{chatLog:[].concat(Object(X.a)(e.chatLog),[t])}})},n.onerror=function(e){console.log("socket connection closed unexcpectedly"),console.error(e)},n.onclose=function(e){console.log("closing connection...")},this.setState({socket:n}),b.a.get("/api/message/room/".concat(this.state.roomName,"/"),{headers:{Authorization:"Token ".concat(e)}}).then(function(e){var t=[],a=!0,n=!1,r=void 0;try{for(var s,c=e.data[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var l=s.value;t.push({key:l.id,message:l.text,username:l.sender_name,created:l.created_on})}}catch(i){n=!0,r=i}finally{try{a||null==c.return||c.return()}finally{if(n)throw r}}o.setState(function(e){return{chatLog:[].concat(Object(X.a)(e.chatLog),t)}})}).catch(function(e){e.response&&404!==e.response.status&&console.log(e.response.statusText,e.response.statusMessage)})}},{key:"render",value:function(){var e=this,t=this.state.chatLog;return o.a.createElement(q.Section,{className:"bg-purple-800 h-screen"},o.a.createElement(K.Container,{className:"h-full"},o.a.createElement("div",{className:"flex flex-col h-full"},o.a.createElement("div",{className:"text-3xl text-center p-2 flex-auto room__name w-full border-solid border-2 border-white-500 flex-auto"},"Room Name : ",this.props.match.params.roomName),o.a.createElement("div",{className:"chat_log__flex flex-auto flex flex-row w-full border-solid border-2 border-t-0 border-white-500 flex-auto"},o.a.createElement("div",{className:"chat_log w-10/12 p-2 border-solid border-r-2 border-white-500 flex-auto flex flex-col overflow-y-scroll"},t.map(function(e){return o.a.createElement("div",{key:e.key,className:"p-1"},o.a.createElement("span",{className:"message__username has-text-primary"},e.username)," :"," ",o.a.createElement("span",{className:"message__message break-words"},e.message))})),o.a.createElement("div",{className:"user_list w-2/12 flex-auto flex flex-col"},o.a.createElement("span",{className:"has-text-primary text-center"},"Online Users"),o.a.createElement("ul",null,o.a.createElement("li",{className:"text-center has-text-primary"},"user1"),o.a.createElement("li",{className:"text-center has-text-primary"},"user2"),o.a.createElement("li",{className:"text-center has-text-primary"},"user3"),o.a.createElement("li",{className:"text-center has-text-primary"},"user4")))),o.a.createElement(K.Container,{className:"mt-4"},o.a.createElement(ee.Field,null,o.a.createElement(ae.TextArea,{isSize:"medium",placeholder:"Enter message",onChange:function(t){var a=t.target.value;e.setState(function(e){return{message:a}})},onKeyDown:this.keyDownHandler,className:"resize-none shadow rounded border max-w-sm py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:bg-white focus:border-purple-500",value:this.state.message})),o.a.createElement(ee.Field,null,o.a.createElement(te.Control,null,o.a.createElement($.Button,{isColor:"primary",onClick:this.sendMessage},o.a.createElement("span",{className:"has-text-info"}," Submit "))))))))}}]),t}(n.Component)),oe={position:w.b.BOTTOM_CENTER,timeout:5e3,offset:"30px",transition:w.c.SCALE},re=function(e){return o.a.createElement(n.Fragment,null,o.a.createElement(G,null),o.a.createElement(C,null),o.a.createElement(j,e))},se=function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement(g.a,{store:U},o.a.createElement(_.a,null,o.a.createElement(w.a,Object.assign({template:N.a},oe),o.a.createElement(W.a,{basename:Z},o.a.createElement(y.d,null,o.a.createElement(y.b,{path:"/",exact:!0,component:z}),o.a.createElement(y.b,{path:"/login",component:re}),o.a.createElement(y.b,{path:"/room",exact:!0,component:Q}),o.a.createElement(y.b,{path:"/room/:roomName",component:ne}))))))}}]),t}(n.Component);a(107),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ce=a(64);a.n(ce).a.config(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_SENTRY_URL).install();var le=document.getElementById("root");s.a.render(o.a.createElement(se,null),le),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},65:function(e,t,a){e.exports=a(113)}},[[65,1,2]]]);
//# sourceMappingURL=main.5406f2ca.chunk.js.map