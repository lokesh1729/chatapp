(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{103:function(e,t,n){},105:function(e,t,n){},106:function(e,t,n){},107:function(e,t,n){},113:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(20),s=n.n(r),c=n(5),l=n(6),i=n(8),u=n(7),m=n(9),p=n(31),h=n(54),d=n.n(h),g=n(15),f=n(32),b=n.n(f),E=function(e,t,n){return{type:e,payload:{msg:t,status:n}}},O=n(22),y=n(10),v=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(i.a)(this,Object(u.a)(t).call(this,e))).submitLogin=function(e){e.preventDefault(),n.props.login(n.state.username,n.state.password)},n.onChange=function(e){n.setState(Object(p.a)({},e.target.name,e.target.value))},n.state={username:"",password:""},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.state.isAuthenticated,t=d.a.parse(this.props.location.search).next;return o.a.createElement(a.Fragment,null,e?o.a.createElement(O.a,{to:t}):o.a.createElement(y.Section,{className:this.props.state.isLoading?"opacity-25":""},o.a.createElement(y.Container,null,o.a.createElement("form",{onSubmit:this.submitLogin},o.a.createElement(y.Field,null,o.a.createElement(y.Label,null,"Username"),o.a.createElement(y.Control,null,o.a.createElement(y.Input,{type:"text",onChange:this.onChange,name:"username",placeholder:"Enter username",required:!0}))),o.a.createElement(y.Field,null,o.a.createElement(y.Label,null,"Password"),o.a.createElement(y.Control,null,o.a.createElement(y.Input,{type:"password",onChange:this.onChange,name:"password",placeholder:"Enter password",required:!0}))),o.a.createElement(y.Field,null,o.a.createElement(y.Control,null,o.a.createElement(y.Button,{isColor:"primary",type:"submit"},"Submit")))))))}}]),t}(a.Component),j=Object(g.b)(function(e){return{state:e.login}},{login:function(e,t){return function(n){var a=JSON.stringify({username:e,password:t});n({type:"HTTP_CALL_INITIATED"}),b.a.post("/api/auth/login/",a,{headers:{"Content-Type":"application/json"}}).then(function(e){200===e.status?(n({type:"LOGIN",payload:e.data}),n({type:"MESSAGE",payload:{loginSuccess:"logged in successfully"}})):n(E("ERROR",e.statusText,e.status)),n({type:"HTTP_CALL_COMPLETED"})}).catch(function(e){n({type:"HTTP_CALL_COMPLETED"}),e.response&&n(E("ERROR",e.response.data,e.response.status)),console.log(e),n(E("ERROR",e.message,500))}).catch(function(e){return n(E("ERROR","Something went wrong!!!",e.response.status))})}}})(v),w=n(26),N=n(57),C=(n(103),function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e,t){var n=this.props,a=n.errors,o=n.alert,r=n.messages;a!==e.errors&&(a.msg.name&&o.error("Name: ".concat(a.msg.name.join())),a.msg.email&&o.error("".concat(a.status," : Email: ").concat(a.msg.email.join())),a.msg.non_field_errors&&o.error("".concat(a.status," : ").concat(a.msg.non_field_errors.join())),a.msg.username&&o.error(a.msg.username.join())),r!==e.messages&&r.loginSuccess&&o.success(r.loginSuccess)}},{key:"render",value:function(){return o.a.createElement(a.Fragment,null)}}]),t}(a.Component)),_=Object(g.b)(function(e){return{errors:e.errors,messages:e.messages}})(Object(w.d)()(C)),x=n(35),k=n(21),L=n(58),T=n(59),S=n(36),R=n(104),D={isAuthenticated:!!R.get("authToken"),isLoading:!1},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":var n=t.payload.token;return R.set("authToken",n,{path:"/",expires:new Date(t.payload.expiry)}),Object(S.a)({},e,{isAuthenticated:!0});case"HTTP_CALL_INITIATED":return Object(S.a)({},e,{isLoading:!0});case"HTTP_CALL_COMPLETED":return Object(S.a)({},e,{isLoading:!1});default:return e}},I={msg:{},status:""},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;return"ERROR"===t.type?{msg:t.payload.msg,status:t.payload.status}:e},M={msg:{}},F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MESSAGE":return t.payload;default:return e}},H=Object(k.combineReducers)({login:A,errors:P,messages:F}),B=[T.a],U=Object(k.createStore)(H,{},Object(L.composeWithDevTools)(k.applyMiddleware.apply(void 0,B))),J=function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement(a.Fragment,null,this.props.isLoading&&o.a.createElement("div",{className:"spinner"},o.a.createElement("img",{src:"assets/spinner.gif",alt:"loading"})))}}]),t}(a.Component),G=Object(g.b)(function(e){return{isLoading:e.login.isLoading}})(J),W=n(30),z=function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null,"Home Page")}}]),t}(a.Component),q=n(33),K=n(28),V=n(60),Y=n(61),$=(n(105),n(34)),Q=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(i.a)(this,Object(u.a)(t).call(this,e))).enterRoom=function(e){e.preventDefault(),n.props.history.push("/room/"+n.state.roomName)},n.roomNameChange=function(e){var t=e.target.value;n.setState(function(e){return{roomName:t}})},n.keyDownHandler=function(e){13===e.keyCode&&n.enterRoom(e)},n.state={roomName:""},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement(q.Section,{className:"room_enter__section"},o.a.createElement(K.Container,{className:"room__container"},o.a.createElement(Y.Label,{className:"room__label"},"Enter a room name:"),o.a.createElement(V.Input,{type:"text",className:"room__input",onChange:this.roomNameChange,onKeyDown:this.keyDownHandler}),o.a.createElement($.Button,{isColor:"primary",className:"large__btn",onClick:this.enterRoom},"Enter")))}}]),t}(a.Component),X=n(44),Z="/app";var ee=n(43),te=n(62),ne=(n(106),n(63)),ae=function(e){var t=function(t){function n(){return Object(c.a)(this,n),Object(i.a)(this,Object(u.a)(n).apply(this,arguments))}return Object(m.a)(n,t),Object(l.a)(n,[{key:"render",value:function(){var t,n=this.props.state.isAuthenticated;return o.a.createElement(a.Fragment,null,n?o.a.createElement(e,this.props):o.a.createElement(O.a,{to:"/login?next=".concat(encodeURIComponent((t=this.props.location.pathname+this.props.location.search,t.split(Z).join(""))))}))}}]),n}(o.a.Component);return Object(g.b)(function(e){return{state:e.login}},null)(Object(x.b)(t))}(function(e){function t(e){var n;Object(c.a)(this,t),(n=Object(i.a)(this,Object(u.a)(t).call(this,e))).sendMessage=function(e){e.preventDefault(),n.state.socket.send(JSON.stringify({message:n.state.message,room_name:n.state.roomName})),n.setState(function(e){return{message:""}})},n.keyDownHandler=function(e){13===e.keyCode&&n.sendMessage(e)};var a=n.props.match.params.roomName;return n.state={socket:null,chatLog:[],message:"",roomName:a},n}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.cookies.get("authToken"),t="https:"===window.location.protocol?"wss:":"ws:",n=window.location.host,a=new WebSocket("".concat(t,"//").concat(n,"/ws/chat/").concat(this.state.roomName,"/")),o=this;a.onopen=function(e){console.log("opened connection...")},a.onmessage=function(e){var t=JSON.parse(e.data);o.setState(function(e){return{chatLog:[].concat(Object(X.a)(e.chatLog),[t])}})},a.onerror=function(e){console.log("socket connection closed unexcpectedly"),console.error(e)},a.onclose=function(e){console.log("closing connection...")},this.setState({socket:a}),b.a.get("/api/message/room/".concat(this.state.roomName,"/"),{headers:{Authorization:"Token ".concat(e)}}).then(function(e){var t=[],n=!0,a=!1,r=void 0;try{for(var s,c=e.data[Symbol.iterator]();!(n=(s=c.next()).done);n=!0){var l=s.value;t.push({key:l.id,message:l.text,username:l.sender_name,created:l.created_on})}}catch(i){a=!0,r=i}finally{try{n||null==c.return||c.return()}finally{if(a)throw r}}o.setState(function(e){return{chatLog:[].concat(Object(X.a)(e.chatLog),t)}})}).catch(function(e){e.response&&404!==e.response.status&&console.log(e.response.statusText,e.response.statusMessage)})}},{key:"render",value:function(){var e=this,t=this.state.chatLog;return o.a.createElement(q.Section,{className:"bg-purple-400 h-screen"},o.a.createElement(K.Container,{className:"h-full"},o.a.createElement("div",{className:"flex flex-col h-full"},o.a.createElement("div",{className:"text-3xl text-center flex-auto room__name w-full border-solid border-2 border-white-500 flex-auto"},"Room Name : ",this.props.match.params.roomName),o.a.createElement("div",{className:"chat_log__flex flex-auto flex flex-row w-full border-solid border-2 border-t-0 border-white-500 flex-auto"},o.a.createElement("div",{className:"chat_log w-9/12 border-solid border-r-2 border-white-500 flex-auto"},t.map(function(e){return o.a.createElement("div",{key:e.key},o.a.createElement("span",{className:"message__username text-white"},e.username)," :"," ",o.a.createElement("span",{className:"message__message break-words"},e.message))})),o.a.createElement("div",{className:"user_list w-3/12"},o.a.createElement("ul",null,o.a.createElement("li",{className:"text-center has-text-info"},"user1"),o.a.createElement("li",{className:"text-center has-text-info"},"user2"),o.a.createElement("li",{className:"text-center has-text-info"},"user3"),o.a.createElement("li",{className:"text-center has-text-info"},"user4")))),o.a.createElement(K.Container,{className:"mt-4"},o.a.createElement(ee.Field,null,o.a.createElement(ne.TextArea,{isSize:"medium",placeholder:"Enter message",onChange:function(t){var n=t.target.value;e.setState(function(e){return{message:n}})},onKeyDown:this.keyDownHandler,className:"resize-none shadow rounded border max-w-sm py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:bg-white focus:border-purple-500",value:this.state.message})),o.a.createElement(ee.Field,null,o.a.createElement(te.Control,null,o.a.createElement($.Button,{isColor:"primary",onClick:this.sendMessage},"Submit")))))))}}]),t}(a.Component)),oe={position:w.b.BOTTOM_CENTER,timeout:5e3,offset:"30px",transition:w.c.SCALE},re=function(e){return o.a.createElement(a.Fragment,null,o.a.createElement(G,null),o.a.createElement(_,null),o.a.createElement(j,e))},se=function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement(g.a,{store:U},o.a.createElement(x.a,null,o.a.createElement(w.a,Object.assign({template:N.a},oe),o.a.createElement(W.a,{basename:Z},o.a.createElement(O.d,null,o.a.createElement(O.b,{path:"/",exact:!0,component:z}),o.a.createElement(O.b,{path:"/login",component:re}),o.a.createElement(O.b,{path:"/room",exact:!0,component:Q}),o.a.createElement(O.b,{path:"/room/:roomName",component:ae}))))))}}]),t}(a.Component);n(107),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ce=n(64);n.n(ce).a.config(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_SENTRY_URL).install();var le=document.getElementById("root");s.a.render(o.a.createElement(se,null),le),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},65:function(e,t,n){e.exports=n(113)}},[[65,1,2]]]);
//# sourceMappingURL=main.92a3fe92.chunk.js.map