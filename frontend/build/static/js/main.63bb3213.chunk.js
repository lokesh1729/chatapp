(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{103:function(e,t,a){},105:function(e,t,a){},106:function(e,t,a){},107:function(e,t,a){},113:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(20),s=a.n(o),c=a(5),l=a(6),i=a(8),u=a(7),m=a(9),p=a(31),h=a(54),d=a.n(h),g=a(13),f=a(32),E=a.n(f),b=function(e,t,a){return{type:e,payload:{msg:t,status:a}}},y=function(e,t){return{type:e,payload:t}},O=a(22),v=a(10),j=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).submitLogin=function(e){e.preventDefault(),a.props.login(a.state.username,a.state.password)},a.onChange=function(e){a.setState(Object(p.a)({},e.target.name,e.target.value))},a.state={username:"",password:""},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.state.isAuthenticated,t=d.a.parse(this.props.location.search).next;return r.a.createElement(n.Fragment,null,e?r.a.createElement(O.a,{to:t}):r.a.createElement(v.Section,{className:this.props.state.isLoading?"opacity-25":""},r.a.createElement(v.Container,null,r.a.createElement("form",{onSubmit:this.submitLogin},r.a.createElement(v.Field,null,r.a.createElement(v.Label,null,"Username"),r.a.createElement(v.Control,null,r.a.createElement(v.Input,{type:"text",onChange:this.onChange,name:"username",placeholder:"Enter username",required:!0}))),r.a.createElement(v.Field,null,r.a.createElement(v.Label,null,"Password"),r.a.createElement(v.Control,null,r.a.createElement(v.Input,{type:"password",onChange:this.onChange,name:"password",placeholder:"Enter password",required:!0}))),r.a.createElement(v.Field,null,r.a.createElement(v.Control,null,r.a.createElement(v.Button,{isColor:"info",type:"submit"},"Submit")))))))}}]),t}(n.Component),w=Object(g.b)(function(e){return{state:e.login}},{login:function(e,t){return function(a){var n=JSON.stringify({username:e,password:t});a({type:"HTTP_CALL_INITIATED"}),E.a.post("/api/auth/login/",n,{headers:{"Content-Type":"application/json"}}).then(function(e){200===e.status?(a({type:"LOGIN",payload:e.data}),a(y("MESSAGE",{loginSuccess:"logged in successfully"}))):a(b("ERROR",e.statusText,e.status)),a({type:"HTTP_CALL_COMPLETED"})}).catch(function(e){a({type:"HTTP_CALL_COMPLETED"}),e.response&&a(b("ERROR",e.response.data,e.response.status)),console.log(e),a(b("ERROR",e.message,500))}).catch(function(e){return a(b("ERROR","Something went wrong!!!",e.response.status))})}}})(j),N=a(26),x=a(57),C=(a(103),function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e,t){var a=this.props,n=a.errors,r=a.alert,o=a.messages;n!==e.errors&&(n.msg.name&&r.error("Name: ".concat(n.msg.name.join())),n.msg.email&&r.error("".concat(n.status," : Email: ").concat(n.msg.email.join())),n.msg.non_field_errors&&r.error("".concat(n.status," : ").concat(n.msg.non_field_errors.join())),n.msg.username&&r.error(n.msg.username.join()),n.msg.emptyMessage&&r.error(n.msg.emptyMessage),n.msg.error&&r.error(n.msg.error)),o!==e.messages&&(o.loginSuccess&&r.success(o.loginSuccess),o.success&&r.success(o.success))}},{key:"render",value:function(){return r.a.createElement(n.Fragment,null)}}]),t}(n.Component)),_=Object(g.b)(function(e){return{errors:e.errors,messages:e.messages}})(Object(N.d)()(C)),k=a(35),L=a(21),R=a(58),S=a(59),T=a(36),A=a(104),D={isAuthenticated:!!A.get("authToken"),isLoading:!1},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":var a=t.payload.token;return A.set("authToken",a,{path:"/",expires:new Date(t.payload.expiry)}),Object(T.a)({},e,{isAuthenticated:!0});case"HTTP_CALL_INITIATED":return Object(T.a)({},e,{isLoading:!0});case"HTTP_CALL_COMPLETED":return Object(T.a)({},e,{isLoading:!1});default:return e}},I={msg:{},status:""},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;return"ERROR"===t.type?{msg:t.payload.msg,status:t.payload.status}:e},F={msg:{}},H=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F,t=arguments.length>1?arguments[1]:void 0;return"MESSAGE"===t.type?t.payload:e},B=Object(L.combineReducers)({login:M,errors:P,messages:H}),U=[S.a],G=Object(L.createStore)(B,{},Object(R.composeWithDevTools)(L.applyMiddleware.apply(void 0,U))),J=function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(n.Fragment,null,this.props.isLoading&&r.a.createElement("div",{className:"spinner"},r.a.createElement("img",{src:"assets/spinner.gif",alt:"loading"})))}}]),t}(n.Component),W=Object(g.b)(function(e){return{isLoading:e.login.isLoading}})(J),z=a(30),q=function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,"Home Page")}}]),t}(n.Component),K=a(33),V=a(28),Y=a(60),$=a(61),Q=(a(105),a(34)),X=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).enterRoom=function(e){e.preventDefault(),a.props.history.push("/room/"+a.state.roomName)},a.roomNameChange=function(e){var t=e.target.value;a.setState(function(e){return{roomName:t}})},a.keyDownHandler=function(e){13===e.keyCode&&a.enterRoom(e)},a.state={roomName:""},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(K.Section,{className:"room_enter__section"},r.a.createElement(V.Container,{className:"room__container"},r.a.createElement($.Label,{className:"room__label"},"Enter a room name:"),r.a.createElement(Y.Input,{type:"text",className:"room__input",onChange:this.roomNameChange,onKeyDown:this.keyDownHandler}),r.a.createElement(Q.Button,{isColor:"primary",className:"large__btn",onClick:this.enterRoom},"Enter")))}}]),t}(n.Component),Z=a(44),ee="/app";var te=a(43),ae=a(62),ne=(a(106),a(63)),re=function(e){function t(e){var a;Object(c.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).sendMessage=function(e){e.preventDefault(),a.state.message?(a.state.socket.send(JSON.stringify({message:a.state.message,room_name:a.state.roomName})),a.setState(function(e){return{message:""}})):a.props.alert("ERROR",{emptyMessage:"please enter a message"})},a.keyDownHandler=function(e){13===e.keyCode&&a.sendMessage(e)};var n=a.props.match.params.roomName;return a.state={socket:null,chatLog:[],message:"",roomName:n},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.cookies.get("authToken"),t="https:"===window.location.protocol?"wss:":"ws:",a=window.location.host,n=new WebSocket("".concat(t,"//").concat(a,"/ws/chat/").concat(this.state.roomName,"/")),r=this;n.onopen=function(e){console.log("opened connection...")},n.onmessage=function(e){var t=JSON.parse(e.data);r.setState(function(e){return{chatLog:[].concat(Object(Z.a)(e.chatLog),[t])}})},n.onerror=function(e){console.log("socket connection closed unexcpectedly"),console.error(e)},n.onclose=function(e){console.log("closing connection...")},this.setState({socket:n}),E.a.get("/api/message/room/".concat(this.state.roomName,"/"),{headers:{Authorization:"Token ".concat(e)}}).then(function(e){var t=[],a=!0,n=!1,o=void 0;try{for(var s,c=e.data[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var l=s.value;t.push({key:l.id,message:l.text,username:l.sender_name,created:l.created_on})}}catch(i){n=!0,o=i}finally{try{a||null==c.return||c.return()}finally{if(n)throw o}}r.setState(function(e){return{chatLog:[].concat(Object(Z.a)(e.chatLog),t)}})}).catch(function(e){e.response&&404!==e.response.status&&console.log(e.response.statusText,e.response.statusMessage)})}},{key:"render",value:function(){var e=this,t=this.state.chatLog;return r.a.createElement(K.Section,{className:"bg-purple-800 h-screen"},r.a.createElement(V.Container,{className:"h-full"},r.a.createElement("div",{className:"flex flex-col h-full"},r.a.createElement("div",{className:"text-3xl text-center p-2 flex-auto room__name w-full border-solid border-2 border-white-500 flex-auto"},"Room Name : ",this.props.match.params.roomName),r.a.createElement("div",{className:"chat_log__flex flex-auto flex flex-row w-full border-solid border-2 border-t-0 border-white-500 flex-auto"},r.a.createElement("div",{className:"chat_log w-10/12 p-2 border-solid border-r-2 border-white-500 flex-auto flex flex-col overflow-y-scroll"},t.map(function(e){return r.a.createElement("div",{key:e.key,className:"p-1"},r.a.createElement("span",{className:"message__username has-text-primary"},e.username," : "),r.a.createElement("span",{className:"message__message break-words"},e.message))})),r.a.createElement("div",{className:"user_list w-2/12 flex-auto flex flex-col"},r.a.createElement("span",{className:"has-text-primary text-center"},"Online Users"),r.a.createElement("ul",null,r.a.createElement("li",{className:"text-center has-text-primary"},"user1"),r.a.createElement("li",{className:"text-center has-text-primary"},"user2"),r.a.createElement("li",{className:"text-center has-text-primary"},"user3"),r.a.createElement("li",{className:"text-center has-text-primary"},"user4")))),r.a.createElement(V.Container,{className:"mt-4"},r.a.createElement(te.Field,null,r.a.createElement(ne.TextArea,{isSize:"medium",placeholder:"Enter message",onChange:function(t){var a=t.target.value;e.setState(function(e){return{message:a}})},onKeyDown:this.keyDownHandler,className:"resize-none shadow rounded border max-w-sm py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:bg-white focus:border-purple-500",value:this.state.message})),r.a.createElement(te.Field,null,r.a.createElement(ae.Control,null,r.a.createElement(Q.Button,{isColor:"primary",onClick:this.sendMessage},r.a.createElement("span",{className:"has-text-info"}," Submit "))))))))}}]),t}(n.Component),oe=Object(g.b)(null,{alert:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return function(n){"ERROR"===e&&n(b("ERROR",t,a)),n(y("MESSAGE",t))}}})(function(e){var t=function(t){function a(){return Object(c.a)(this,a),Object(i.a)(this,Object(u.a)(a).apply(this,arguments))}return Object(m.a)(a,t),Object(l.a)(a,[{key:"render",value:function(){var t,a=this.props.state.isAuthenticated;return r.a.createElement(n.Fragment,null,a?r.a.createElement(e,this.props):r.a.createElement(O.a,{to:"/login?next=".concat(encodeURIComponent((t=this.props.location.pathname+this.props.location.search,t.split(ee).join(""))))}))}}]),a}(r.a.Component);return Object(g.b)(function(e){return{state:e.login}},null)(Object(k.b)(t))}(re)),se={position:N.b.BOTTOM_CENTER,timeout:5e3,offset:"30px",transition:N.c.SCALE},ce=function(e){return r.a.createElement(n.Fragment,null,r.a.createElement(W,null),r.a.createElement(_,null),r.a.createElement(w,e))},le=function(e){return r.a.createElement(n.Fragment,null,r.a.createElement(_,null),r.a.createElement(oe,e))},ie=function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(g.a,{store:G},r.a.createElement(k.a,null,r.a.createElement(N.a,Object.assign({template:x.a},se),r.a.createElement(z.a,{basename:ee},r.a.createElement(O.d,null,r.a.createElement(O.b,{path:"/",exact:!0,component:q}),r.a.createElement(O.b,{path:"/login",component:ce}),r.a.createElement(O.b,{path:"/room",exact:!0,component:X}),r.a.createElement(O.b,{path:"/room/:roomName",component:le}))))))}}]),t}(n.Component);a(107),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ue=a(64);a.n(ue).a.config(Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_SENTRY_URL).install();var me=document.getElementById("root");s.a.render(r.a.createElement(ie,null),me),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},65:function(e,t,a){e.exports=a(113)}},[[65,1,2]]]);
//# sourceMappingURL=main.63bb3213.chunk.js.map